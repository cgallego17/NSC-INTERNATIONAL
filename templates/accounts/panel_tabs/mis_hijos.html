{% load i18n %}
{% load translation_tags %}
<div class="tab-content-header mb-4">
    <h4 style="color: var(--mlb-blue); font-weight: 800; font-size: 1.5rem; margin-bottom: 10px;">
        <i class="fas fa-child me-2" style="color: var(--mlb-red);"></i>{% trans "My Children/Players" %}
    </h4>
    <p class="text-muted">{% trans "Manage registered players" %}</p>
</div>

{% if parent_players %}
    <div style="background: white; border-radius: 16px; padding: 0; box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow: hidden;">
        {% for player in parent_players %}
            <div class="player-list-item" style="padding: 20px 25px; border-bottom: 1px solid #e9ecef; display: flex; align-items: center; gap: 20px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa';" onmouseout="this.style.background='white';">
                {% if forloop.last %}
                    <style>
                        .player-list-item:last-child {
                            border-bottom: none !important;
                        }
                    </style>
                {% endif %}

                <!-- Foto de perfil -->
                <div style="flex-shrink: 0;">
                    {% if player.user.profile.profile_picture %}
                        <img src="{{ player.user.profile.profile_picture.url }}" alt="{{ player.user.get_full_name|default:player.user.username }}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid var(--mlb-blue); box-shadow: 0 4px 12px rgba(13, 44, 84, 0.2);">
                    {% else %}
                        <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, var(--mlb-blue) 0%, var(--mlb-light-blue) 100%); display: flex; align-items: center; justify-content: center; border: 3px solid var(--mlb-blue); box-shadow: 0 4px 12px rgba(13, 44, 84, 0.2);">
                            <i class="fas fa-user fa-2x" style="color: white;"></i>
                        </div>
                    {% endif %}
                </div>

                <!-- Información del jugador -->
                <div style="flex: 1; min-width: 0;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 8px; flex-wrap: wrap;">
                        <h5 style="color: var(--mlb-blue); font-weight: 700; font-size: 1.2rem; margin: 0;">
                            {{ player.user.get_full_name|default:player.user.username }}
                        </h5>
                        {% if player.age_verification_document %}
                            <span class="badge bg-success" style="font-size: 0.7rem; padding: 4px 10px;">
                                <i class="fas fa-check-circle me-1"></i>{% trans "Verified" %}
                            </span>
                        {% else %}
                            <span class="badge bg-warning text-dark" style="font-size: 0.7rem; padding: 4px 10px;">
                                <i class="fas fa-clock me-1"></i>{% trans "Pending" %}
                            </span>
                        {% endif %}
                    </div>

                    <div style="display: flex; flex-wrap: wrap; gap: 20px; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-users" style="color: var(--mlb-blue); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">
                                {% if player.team %}
                                    {{ player.team.name }}
                                {% else %}
                                    {% trans "No team assigned" %}
                                {% endif %}
                            </span>
                        </div>

                        {% if player.division %}
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-tag" style="color: var(--mlb-red); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">{{ player.division }}</span>
                        </div>
                        {% endif %}

                        {% if player.grade %}
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-graduation-cap" style="color: var(--mlb-blue); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">{{ player.get_grade_display|default:player.grade|translate_choice }}</span>
                        </div>
                        {% endif %}

                        {% if player.position %}
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-baseball-ball" style="color: var(--mlb-red); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">{{ player.get_position_display|default:player.position|translate_choice }}</span>
                        </div>
                        {% endif %}

                        {% if player.jersey_number %}
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-tshirt" style="color: var(--mlb-blue); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">#{{ player.jersey_number }}</span>
                        </div>
                        {% endif %}

                        {% if player.birth_date %}
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-birthday-cake" style="color: var(--mlb-red); font-size: 0.9rem;"></i>
                            <span style="color: #6c757d; font-size: 0.9rem; font-weight: 500;">{{ player.birth_date|date:"SHORT_DATE_FORMAT" }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Botones de acción -->
                <div style="flex-shrink: 0; display: flex; gap: 10px;">
                    {% if player.pk %}
                    <a href="{% url 'accounts:player_detail' player.pk %}" class="btn btn-sm" style="background: var(--mlb-blue); color: white; border: none; border-radius: 8px; padding: 10px 20px; font-weight: 600; text-decoration: none; transition: all 0.3s; white-space: nowrap;" onmouseover="this.style.background='var(--mlb-light-blue)'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='var(--mlb-blue)'; this.style.transform='translateY(0)';">
                        <i class="fas fa-eye me-1"></i>{% trans "View" %}
                    </a>
                    <button type="button" class="btn btn-sm edit-player-btn" data-player-id="{{ player.pk }}" data-url="{% url 'accounts:player_edit' player.pk %}" data-is-parent="true" data-edit-type="hijo" style="background: var(--mlb-red); color: white; border: none; border-radius: 8px; padding: 10px 20px; font-weight: 600; transition: all 0.3s; white-space: nowrap; cursor: pointer;" onmouseover="this.style.background='#b30029'; this.style.transform='translateY(-2px)';" onmouseout="this.style.background='var(--mlb-red)'; this.style.transform='translateY(0)';">
                        <i class="fas fa-edit me-1"></i>{% trans "Edit Child" %}
                    </button>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- Estadísticas -->
    <div class="mt-4" style="background: linear-gradient(135deg, var(--mlb-blue) 0%, var(--mlb-light-blue) 100%); border-radius: 16px; padding: 25px; color: white;">
        <div class="row text-center">
            <div class="col-md-4 mb-3 mb-md-0">
                <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">{{ parent_players|length }}</div>
                <div style="font-size: 0.9rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 1px;">{% trans "Total Players" %}</div>
            </div>
            <div class="col-md-4 mb-3 mb-md-0">
                <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">
                    {% regroup parent_players by team as teams_grouped %}
                    {{ teams_grouped|length }}
                </div>
                <div style="font-size: 0.9rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 1px;">{% trans "Different Teams" %}</div>
            </div>
            <div class="col-md-4">
                <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">
                    {% regroup parent_players by division as divisions_grouped %}
                    {{ divisions_grouped|length }}
                </div>
                <div style="font-size: 0.9rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 1px;">{% trans "Divisions" %}</div>
            </div>
        </div>
    </div>
{% else %}
    <div style="background: white; border-radius: 16px; padding: 60px 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); text-align: center;">
        <div style="width: 120px; height: 120px; margin: 0 auto 25px; background: linear-gradient(135deg, var(--mlb-blue) 0%, var(--mlb-light-blue) 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(13, 44, 84, 0.2);">
            <i class="fas fa-child fa-3x" style="color: white;"></i>
        </div>
        <h5 style="color: var(--mlb-blue); font-weight: 700; margin-bottom: 15px;">{% trans "No Players Registered Yet" %}</h5>
        <p class="text-muted mb-4" style="font-size: 1.1rem; max-width: 500px; margin-left: auto; margin-right: auto;">
            {% trans "You haven't registered any players yet. Start by registering your first child/player." %}
        </p>
        <button type="button" class="tab-btn" data-tab="registrar-hijo" data-url="{% url 'accounts:parent_player_register' %}" style="background: linear-gradient(135deg, var(--mlb-red) 0%, #b30029 100%); color: white; border: none; border-radius: 10px; padding: 14px 35px; font-weight: 700; text-transform: uppercase; font-size: 0.95rem; letter-spacing: 0.8px; display: inline-flex; align-items: center; gap: 10px; box-shadow: 0 4px 15px rgba(213, 0, 50, 0.4); transition: all 0.3s; cursor: pointer;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 25px rgba(213, 0, 50, 0.5)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(213, 0, 50, 0.4)';">
            <i class="fas fa-user-plus"></i>{% trans "Register First Player" %}
        </button>
    </div>
{% endif %}

<style>
@media (max-width: 768px) {
    .player-list-item {
        flex-direction: column !important;
        align-items: flex-start !important;
        padding: 20px !important;
    }

    .player-list-item > div:last-child {
        width: 100% !important;
        margin-top: 15px;
        justify-content: flex-start !important;
    }

    .player-list-item > div:last-child .btn {
        flex: 1;
        min-width: auto;
    }
}
</style>
